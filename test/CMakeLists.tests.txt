#--------------------------------
# testing

find_program(CTEST_EXECUTABLE ctest)
if(NOT CTEST_EXECUTABLE)
    message(FATAL_ERROR "ctest not found!")
endif()

include(FetchContent)
FetchContent_Declare(
  googletest
  GIT_REPOSITORY https://github.com/google/googletest.git
  GIT_TAG        3fa7f983c69f780378b4d1ad44d36030ca951ba6 # dec 17 2022 main
)
FetchContent_MakeAvailable(googletest)
enable_testing()

add_executable(clover_test ${SOURCE_LIST_TEST_FUNCTIONAL_CC})
target_link_libraries(clover_test
    PRIVATE
        Clover
        gtest_main
)

add_executable(clover_test_performance ${SOURCE_LIST_TEST_PERFORMANCE_CC})
target_link_libraries(clover_test_performance
    PRIVATE
        Clover
        gtest_main
)

include(GoogleTest)
gtest_discover_tests(clover_test
                     PROPERTIES
                     LABELS "unit")

gtest_discover_tests(clover_test_performance
                     PROPERTIES
                     LABELS "performance")